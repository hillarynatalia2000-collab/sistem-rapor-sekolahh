<!DOCTYPE html>
<html lang="id" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title th:text="${allowedMenu == 'all' ? 'Dashboard Wali Kelas' : (allowedMenu == 'siswa' ? 'Dashboard Siswa' : 'Dashboard Admin')}">Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" th:href="@{/css/person.css}">
  <script>
    tailwind.config = { theme: { extend: {} } };
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-50 text-gray-800" th:attr="data-success=${success}">
  <div th:replace="~{navigasi :: nav}"></div>
  <div class="max-w-7xl mx-auto p-6 pt-24">
    <div class="flex items-center gap-3 mb-6">
      <i th:if="${allowedMenu == 'all'}" class="fa-solid fa-chalkboard-user text-[var(--brand)] text-2xl"></i>
      <i th:if="${allowedMenu == 'siswa'}" class="fa-solid fa-graduation-cap text-[var(--brand)] text-2xl"></i>
      <i th:if="${allowedMenu == 'admin'}" class="fa-solid fa-shield-halved text-[var(--brand)] text-2xl"></i>
      <h1 class="text-2xl font-semibold">
        <span th:if="${allowedMenu == 'all'}">Dashboard Wali Kelas</span>
        <span th:if="${allowedMenu == 'siswa'}">Dashboard Siswa</span>
        <span th:if="${allowedMenu == 'admin'}">Dashboard Admin</span>
      </h1>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-[260px_1fr] gap-6">
      <div th:replace="~{sidebar :: sidebar(false, ${allowedMenu})}"></div>
      
      <div class="grid grid-cols-1 gap-6">
        <!-- Statistik Cards -->
        <!-- Dashboard Admin -->
        <div th:if="${allowedMenu == 'admin'}" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
          <!-- Card Person -->
          <div class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-blue-500">
            <div class="flex items-center justify-between mb-2">
              <div class="p-3 bg-blue-100 rounded-lg">
                <i class="fa-solid fa-users text-blue-600 text-xl"></i>
              </div>
            </div>
            <h3 class="text-sm text-gray-600 mb-1">Total Person</h3>
            <p class="text-2xl font-bold text-gray-800" th:text="${totalPerson}">0</p>
          </div>

          <!-- Card Siswa -->
          <div class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-green-500">
            <div class="flex items-center justify-between mb-2">
              <div class="p-3 bg-green-100 rounded-lg">
                <i class="fa-solid fa-graduation-cap text-green-600 text-xl"></i>
              </div>
            </div>
            <h3 class="text-sm text-gray-600 mb-1">Total Siswa</h3>
            <p class="text-2xl font-bold text-gray-800" th:text="${totalSiswa}">0</p>
          </div>

          <!-- Card Wali Kelas -->
          <div class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-purple-500">
            <div class="flex items-center justify-between mb-2">
              <div class="p-3 bg-purple-100 rounded-lg">
                <i class="fa-solid fa-chalkboard-user text-purple-600 text-xl"></i>
              </div>
            </div>
            <h3 class="text-sm text-gray-600 mb-1">Total Wali Kelas</h3>
            <p class="text-2xl font-bold text-gray-800" th:text="${totalWaliKelas}">0</p>
          </div>

          <!-- Card Mata Pelajaran -->
          <div class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-orange-500">
            <div class="flex items-center justify-between mb-2">
              <div class="p-3 bg-orange-100 rounded-lg">
                <i class="fa-solid fa-book text-orange-600 text-xl"></i>
              </div>
            </div>
            <h3 class="text-sm text-gray-600 mb-1">Total Mata Pelajaran</h3>
            <p class="text-2xl font-bold text-gray-800" th:text="${totalMataPelajaran}">0</p>
          </div>

          <!-- Card Raport -->
          <div class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-red-500">
            <div class="flex items-center justify-between mb-2">
              <div class="p-3 bg-red-100 rounded-lg">
                <i class="fa-solid fa-file-lines text-red-600 text-xl"></i>
              </div>
            </div>
            <h3 class="text-sm text-gray-600 mb-1">Total Raport</h3>
            <p class="text-2xl font-bold text-gray-800" th:text="${totalRaport}">0</p>
          </div>
        </div>

        <!-- Dashboard Siswa -->
        <div th:if="${allowedMenu == 'siswa'}" class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <!-- Card Kelas -->
          <div class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-blue-500">
            <div class="flex items-center justify-between mb-2">
              <div class="p-3 bg-blue-100 rounded-lg">
                <i class="fa-solid fa-chalkboard text-blue-600 text-xl"></i>
              </div>
            </div>
            <h3 class="text-sm text-gray-600 mb-1">Kelas</h3>
            <p class="text-2xl font-bold text-gray-800" th:text="${siswaKelas != null ? siswaKelas : '-'}">-</p>
          </div>

          <!-- Card NIS -->
          <div class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-green-500">
            <div class="flex items-center justify-between mb-2">
              <div class="p-3 bg-green-100 rounded-lg">
                <i class="fa-solid fa-id-card text-green-600 text-xl"></i>
              </div>
            </div>
            <h3 class="text-sm text-gray-600 mb-1">NIS</h3>
            <p class="text-2xl font-bold text-gray-800" th:text="${siswaNIS != null ? siswaNIS : '-'}">-</p>
          </div>

          <!-- Card Total Raport -->
          <div class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-purple-500">
            <div class="flex items-center justify-between mb-2">
              <div class="p-3 bg-purple-100 rounded-lg">
                <i class="fa-solid fa-file-lines text-purple-600 text-xl"></i>
              </div>
            </div>
            <h3 class="text-sm text-gray-600 mb-1">Total Raport</h3>
            <p class="text-2xl font-bold text-gray-800" th:text="${totalRaportSiswa}">0</p>
          </div>
        </div>

        <!-- Dashboard Wali Kelas -->
        <div th:if="${allowedMenu == 'all'}" class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Card Kelas Walian -->
          <div class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-purple-500">
            <div class="flex items-center justify-between mb-2">
              <div class="p-3 bg-purple-100 rounded-lg">
                <i class="fa-solid fa-chalkboard-user text-purple-600 text-xl"></i>
              </div>
            </div>
            <h3 class="text-sm text-gray-600 mb-1">Kelas Walian</h3>
            <p class="text-2xl font-bold text-gray-800" th:text="${namaKelasWalian}">-</p>
          </div>

          <!-- Card Siswa -->
          <div class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-green-500">
            <div class="flex items-center justify-between mb-2">
              <div class="p-3 bg-green-100 rounded-lg">
                <i class="fa-solid fa-graduation-cap text-green-600 text-xl"></i>
              </div>
            </div>
            <h3 class="text-sm text-gray-600 mb-1">Total Siswa</h3>
            <p class="text-2xl font-bold text-gray-800" th:text="${totalSiswa}">0</p>
          </div>

          <!-- Card Raport -->
          <div class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-red-500">
            <div class="flex items-center justify-between mb-2">
              <div class="p-3 bg-red-100 rounded-lg">
                <i class="fa-solid fa-file-lines text-red-600 text-xl"></i>
              </div>
            </div>
            <h3 class="text-sm text-gray-600 mb-1">Total Raport</h3>
            <p class="text-2xl font-bold text-gray-800" th:text="${totalRaport}">0</p>
          </div>
        </div>

        <!-- Quick Actions -->
        <section class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-[var(--brand)]">
          <div class="flex items-center gap-2 mb-4">
            <i class="fa-solid fa-bolt text-gray-700"></i>
            <h2 class="text-lg font-semibold">Aksi Cepat</h2>
          </div>
          <!-- Quick Actions untuk Admin -->
          <div th:if="${allowedMenu == 'admin'}" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <a th:href="@{/siswa}" class="p-4 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
              <div class="flex items-center gap-3">
                <div class="p-2 bg-green-100 rounded-lg">
                  <i class="fa-solid fa-graduation-cap text-green-600"></i>
                </div>
                <div>
                  <h3 class="font-semibold text-gray-800">Kelola Siswa</h3>
                  <p class="text-sm text-gray-600">Lihat dan kelola data siswa</p>
                </div>
              </div>
            </a>

            <a th:href="@{/walikelas}" class="p-4 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
              <div class="flex items-center gap-3">
                <div class="p-2 bg-purple-100 rounded-lg">
                  <i class="fa-solid fa-chalkboard-user text-purple-600"></i>
                </div>
                <div>
                  <h3 class="font-semibold text-gray-800">Kelola Wali Kelas</h3>
                  <p class="text-sm text-gray-600">Lihat dan kelola data wali kelas</p>
                </div>
              </div>
            </a>

            <a th:href="@{/mapel}" class="p-4 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
              <div class="flex items-center gap-3">
                <div class="p-2 bg-orange-100 rounded-lg">
                  <i class="fa-solid fa-book text-orange-600"></i>
                </div>
                <div>
                  <h3 class="font-semibold text-gray-800">Kelola Mata Pelajaran</h3>
                  <p class="text-sm text-gray-600">Lihat dan kelola mata pelajaran</p>
                </div>
              </div>
            </a>
          </div>
          <!-- Quick Actions untuk Siswa -->
          <div th:if="${allowedMenu == 'siswa'}" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <a th:href="@{/siswa/nilai}" class="p-4 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
              <div class="flex items-center gap-3">
                <div class="p-2 bg-green-100 rounded-lg">
                  <i class="fa-solid fa-chart-line text-green-600"></i>
                </div>
                <div>
                  <h3 class="font-semibold text-gray-800">Lihat Nilai</h3>
                  <p class="text-sm text-gray-600">Lihat nilai dan raport Anda</p>
                </div>
              </div>
            </a>

            <a th:href="@{/profile}" class="p-4 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
              <div class="flex items-center gap-3">
                <div class="p-2 bg-blue-100 rounded-lg">
                  <i class="fa-solid fa-user text-blue-600"></i>
                </div>
                <div>
                  <h3 class="font-semibold text-gray-800">Profile</h3>
                  <p class="text-sm text-gray-600">Kelola informasi profile Anda</p>
                </div>
              </div>
            </a>
          </div>

          <!-- Daftar Raport untuk Siswa -->
          <section th:if="${allowedMenu == 'siswa'}" class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-[var(--brand)]">
            <div class="flex items-center gap-2 mb-4">
              <i class="fa-solid fa-file-lines text-gray-700"></i>
              <h2 class="text-lg font-semibold">Daftar Raport</h2>
            </div>
            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-100">
                  <tr>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-600">No</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-600">Nomor Raport</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-600">Tanggal Diterbitkan</th>
                    <th class="px-4 py-2 text-center text-xs font-medium text-gray-600">Aksi</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                  <tr th:if="${raportListSiswa == null or raportListSiswa.isEmpty()}" class="hover:bg-gray-50">
                    <td colspan="4" class="px-4 py-8 text-center text-gray-500">
                      <div class="flex flex-col items-center gap-2">
                        <i class="fa-solid fa-inbox text-4xl text-gray-300"></i>
                        <p class="text-sm">Belum ada raport</p>
                      </div>
                    </td>
                  </tr>
                  <tr th:each="r, i : ${raportListSiswa}" class="hover:bg-gray-50">
                    <td class="px-4 py-2" th:text="${i.index + 1}">1</td>
                    <td class="px-4 py-2" th:text="${r.nomorRapot != null ? r.nomorRapot : '-'}">-</td>
                    <td class="px-4 py-2" th:text="${r.tanggalDiterbitkan != null ? #dates.format(r.tanggalDiterbitkan, 'dd MMMM yyyy') : '-'}">-</td>
                    <td class="px-4 py-2 text-center">
                      <a th:href="@{'/raport/cetak/' + ${r.siswaId}}" class="inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-[var(--brand)] text-white hover:opacity-90" title="Cetak">
                        <i class="fa-solid fa-print"></i>
                        <span>Cetak</span>
                      </a>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>

          <!-- Quick Actions untuk Wali Kelas -->
          <div th:if="${allowedMenu == 'all'}" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <a th:href="@{/siswa}" class="p-4 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
              <div class="flex items-center gap-3">
                <div class="p-2 bg-green-100 rounded-lg">
                  <i class="fa-solid fa-graduation-cap text-green-600"></i>
                </div>
                <div>
                  <h3 class="font-semibold text-gray-800">Kelola Siswa</h3>
                  <p class="text-sm text-gray-600">Lihat dan kelola data siswa di kelas <span th:text="${namaKelasWalian}">-</span></p>
                </div>
              </div>
            </a>

            <a th:href="@{/raport}" class="p-4 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
              <div class="flex items-center gap-3">
                <div class="p-2 bg-red-100 rounded-lg">
                  <i class="fa-solid fa-file-lines text-red-600"></i>
                </div>
                <div>
                  <h3 class="font-semibold text-gray-800">Kelola Raport</h3>
                  <p class="text-sm text-gray-600">Lihat dan kelola raport siswa</p>
                </div>
              </div>
            </a>
          </div>
        </section>

        <!-- Informasi Sistem -->
        <section class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-[var(--brand)]">
          <div class="flex items-center gap-2 mb-4">
            <i class="fa-solid fa-info-circle text-gray-700"></i>
            <h2 class="text-lg font-semibold">Informasi Sistem</h2>
          </div>
          <!-- Informasi untuk Admin -->
          <div th:if="${allowedMenu == 'admin'}" class="space-y-3 text-sm text-gray-700">
            <div class="flex items-start gap-3">
              <i class="fa-solid fa-check-circle text-green-500 mt-1"></i>
              <div>
                <p class="font-semibold">Sistem Informasi Sekolah (SI-SWA)</p>
                <p class="text-gray-600">Platform manajemen data siswa, wali kelas, dan raport</p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <i class="fa-solid fa-shield-halved text-blue-500 mt-1"></i>
              <div>
                <p class="font-semibold">Akses Admin</p>
                <p class="text-gray-600">Sebagai admin, Anda memiliki akses penuh untuk mengelola semua data dalam sistem</p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <i class="fa-solid fa-users-gear text-purple-500 mt-1"></i>
              <div>
                <p class="font-semibold">Manajemen User</p>
                <p class="text-gray-600">Kelola person, siswa, dan wali kelas dari halaman masing-masing</p>
              </div>
            </div>
          </div>
          <!-- Informasi untuk Siswa -->
          <div th:if="${allowedMenu == 'siswa'}" class="space-y-3 text-sm text-gray-700">
            <div class="flex items-start gap-3">
              <i class="fa-solid fa-check-circle text-green-500 mt-1"></i>
              <div>
                <p class="font-semibold">Sistem Informasi Sekolah (SI-SWA)</p>
                <p class="text-gray-600">Platform manajemen data siswa, wali kelas, dan raport</p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <i class="fa-solid fa-graduation-cap text-green-500 mt-1"></i>
              <div>
                <p class="font-semibold">Kelas Anda</p>
                <p class="text-gray-600">Anda berada di kelas <span class="font-semibold" th:text="${siswaKelas != null ? siswaKelas : '-'}">-</span></p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <i class="fa-solid fa-chart-line text-purple-500 mt-1"></i>
              <div>
                <p class="font-semibold">Nilai dan Raport</p>
                <p class="text-gray-600">Lihat nilai dan raport Anda di halaman Nilai</p>
              </div>
            </div>
          </div>

          <!-- Informasi untuk Wali Kelas -->
          <div th:if="${allowedMenu == 'all'}" class="space-y-3 text-sm text-gray-700">
            <div class="flex items-start gap-3">
              <i class="fa-solid fa-check-circle text-green-500 mt-1"></i>
              <div>
                <p class="font-semibold">Sistem Informasi Sekolah (SI-SWA)</p>
                <p class="text-gray-600">Platform manajemen data siswa, wali kelas, dan raport</p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <i class="fa-solid fa-chalkboard-user text-purple-500 mt-1"></i>
              <div>
                <p class="font-semibold">Kelas Walian</p>
                <p class="text-gray-600">Anda adalah wali kelas dari <span class="font-semibold" th:text="${namaKelasWalian}">-</span></p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <i class="fa-solid fa-graduation-cap text-green-500 mt-1"></i>
              <div>
                <p class="font-semibold">Manajemen Siswa</p>
                <p class="text-gray-600">Kelola data siswa di kelas Anda dan buat raport untuk mereka</p>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
  <div th:replace="alert :: alerts"></div>
</body>
</html>

